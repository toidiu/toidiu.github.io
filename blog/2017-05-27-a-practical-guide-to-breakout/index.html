<!DOCTYPE html>
<html>
    <head lang="en">

        <title>toidiu</title>
        <meta name="description"
          content="Apoorv Kothari is software engineer. He studied Engineering at Cooper Union and is intrested in Rust, Kubernetes, Scala, Android, Java.">
        <meta name="keywords"
          content="toidiu, Apoorv Kothari, Android, Scala, java, Cooper Union, blog, talks, code, rust, kubernetes">

        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <!-- Enable responsiveness on mobile devices-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no, target-densitydpi=device-dpi">

        <meta name="ROBOTS" content="INDEX, FOLLOW">

        

        <link rel="stylesheet" type="text/css" href="/main.css">

        <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/dark.min.css">
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js"></script>

        <!-- and it's easy to individually load additional languages -->
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/rust.min.js"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/languages/scala.min.js"></script>

        <script>hljs.highlightAll();</script>
    </head>

    
      <body id=blog-single >
    
        
          
            
<nav id="site-nav">

  
  <a class="nav-link
      "
      href="https:&#x2F;&#x2F;toidiu.com">

      home
    </a>
  
  <a class="nav-link
      "
      href="https:&#x2F;&#x2F;toidiu.com&#x2F;projects&#x2F;">

      projects
    </a>
  
  <a class="nav-link
      "
      href="https:&#x2F;&#x2F;toidiu.com&#x2F;reads&#x2F;">

      reads
    </a>
  
  <a class="nav-link
      "
      href="https:&#x2F;&#x2F;toidiu.com&#x2F;blog&#x2F;">

      blog
    </a>
  

</nav>

          
        

        
<div class="main-container">
  <div id="post-header">
  <h1 class="title">A practical guide to breakOut</h1>
  <div class="date">2017-05-27</div>
  </div>

  <div class="content">
    <p>In this post I will be reviewing <code>scala.collection.breakOut</code> from an application
developer's perspective rather than a functional programming enthusiast. I will discuss
why one would want to use it and how to recognize when it is applicable.</p>
<span id="continue-reading"></span>
<p>When I first saw <code>breakOut</code>, it seemed like an extremely intimidating concept and a little
like black magic. It certainly didn't help that I found explanations of <code>breakOut</code>
intermingled with the equally intimidating concept of <code>CanBuildFrom</code>. This is a shame
because, with proper application, <code>breakOut</code> can make your code run faster.</p>
<p>The full code sample in this blog can be found at
<a href="https://github.com/toidiu/Scala-breakOut">github</a>.</p>
<h4 id="why-we-care">Why we care</h4>
<pre data-lang="scala" class="language-scala "><code class="language-scala" data-lang="scala">val list = List(&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;)

val expensiveMap = list     &#x2F;&#x2F; type Map[Int, String] is infered by the compiler
  .map(n =&gt; n.length -&gt; n)  &#x2F;&#x2F; 1
  .toMap                    &#x2F;&#x2F; 2
</code></pre>
<p>Since Scala eager evaluation by default, this code ends up being memory inefficient. We
first create an intermediate list at line (1) and then convert it to a Map on line (2).
Ideally we could do it all in one step. Well thanks to <code>breakOut</code> we can!</p>
<pre data-lang="scala" class="language-scala "><code class="language-scala" data-lang="scala">import scala.collection.breakOut
val list = List(&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;)

val efficientMap: Map[Int, String] = list   &#x2F;&#x2F; you need to specify the type
  .map(n =&gt; (n.length, n))(breakOut)
</code></pre>
<p>This results in the <code>Map</code> we want without the intermediate list. Win!</p>
<h4 id="when-to-use">When to use</h4>
<p>So when should we use <code>breakOut</code>? An easy way to remember when to use it is if we have the
following list of conditions:</p>
<ul>
<li>we have a traversable collection (List, Seq, Vector)</li>
<li>we want to transform the elements (pairing the string length with the string)</li>
<li>we want the final output to be a <code>Map</code></li>
</ul>
<h4 id="conclusion">Conclusion</h4>
<p>Scala has a robust immutable collections library, which has a tendency to make it more GC
heavy. However, with some attention to the implementation details, it is possible to
remain efficient and functional.</p>

  </div>
</div>


        
  


        
          <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E=" crossorigin="anonymous"></script>
          <script type="text/javascript" src="https://toidiu.com/main.js" ></script>
        
    </body>

</html>

